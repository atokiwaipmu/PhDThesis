\section{Methods}\label{sec:methods}
\section{Dataset Overview}
To achieve high accuracy while minimizing computational time, we employed the \texttt{FASTPM} particle-mesh simulation code \citep{10.1093/mnras/stw2123}. This code enhances convergence by adjusting kick and drift factors to closely adhere to the Zel'dovich approximation, thereby improving the efficiency of structure formation modeling.

In our study, we quantify super-sample covariance in higher-order statistics using two N-body simulations: \textbf{BIGBOX} and \textbf{TILED}. The \textbf{BIGBOX} simulation, conducted as part of the HalfDome project \citep{2024arXiv240717462B}, encompasses a large cosmic volume, whereas the \textbf{TILED} simulation represents a smaller volume with the same resolution as \textbf{BIGBOX}, specifically excluding large-scale modes. The cosmological parameters for both simulations align with those of IllustrisTNG \citep{2019ComAC...6....2N}, as listed in Table~\ref{tab:simulations}.

\begin{table}[h]
\centering
\begin{tabular}{lcc}
\toprule
\textbf{Parameter} & \textbf{Symbol} & \textbf{Value} \\
\midrule
Hubble constant & $H_0$ & 67.74 \, [$\mathrm{km\,s^{-1}\,Mpc^{-1}}$] \\ 
Matter density & $\Omega_m$ & 0.3089 \\
Baryon density & $\Omega_b$ & 0.0486 \\
Amplitude of fluctuations & $\sigma_8$ & 0.8159 \\
Spectral index & $n_s$ & 0.9667 \\
Sum of neutrino masses & $M_{\nu}$ & 0.0 \, [eV] \\
\bottomrule
\end{tabular}
\caption{Cosmological parameters used in the N-body simulations.}\label{tab:simulations}
\end{table}

The \textbf{BIGBOX} simulation models an extensive cubic volume of $L = 3750$ Mpc/h with $6144^3$ particles, enabling detailed capture of large-scale structures. From this data, a full-sky map was generated by first covering an octant of the sky and subsequently extending it to a full-sky projection.

The \textbf{TILED} simulation covers a smaller volume of $L = 625$ Mpc/h, populated with $1024^3$ particles. To achieve resolution parity with the \textbf{BIGBOX} simulation, multiple smaller volumes were tiled together, forming a full-sky map comparable in detail to the \textbf{BIGBOX} simulation but without the inclusion of large-scale modes.

Both simulations commence at an initial redshift of $z = 9$, utilizing an initial linear matter power spectrum at $z = 0$ generated via the \texttt{CLASS} code \citep{2011JCAP...07..034B}. This setup ensures consistency with observational data of the early universe. We evolved the simulations over 60 time steps, reaching the present day ($z = 0$), thereby capturing the non-linear growth of cosmic structures—an aspect crucial for studies of weak gravitational lensing.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/light_cone_configuration.png}
    \caption{Spatial and redshift setup for the \textbf{BIGBOX} and \textbf{TILED} simulations. The left side of the figure features red lines delineating the light cone boundaries, covering a $10^\circ$ field of view on the sky. Overlaid on this are dashed blue grids that partition the overall simulation volume into smaller, manageable tiling regions. Within these grids, the "small box" highlights a specific tiled region that resides inside the extensive \textbf{BIGBOX} volume. The horizontal axis represents the line-of-sight distance measured in comoving megaparsecs per $h$, with the corresponding redshift values displayed on the top axis.} \label{fig:simulationsetting}
\end{figure}
Figure~\ref{fig:simulationsetting} showcases the spatial and redshift setup for the \textbf{BIGBOX} and \textbf{TILED} simulations used in cosmological studies. The left side of the figure features red lines delineating the light cone boundaries, covering a $10^\circ$ field of view on the sky. Overlaid on this are dashed blue grids that partition the overall simulation volume into smaller, manageable tiling regions. Within these grids, the "small box" highlights a specific tiled region that resides inside the extensive \textbf{BIGBOX} volume. The horizontal axis represents the line-of-sight distance measured in comoving megaparsecs per $h$, with the corresponding redshift values displayed on the top axis. 

\section{Generating Convergence Maps}
To simulate the weak gravitational lensing effect observed in surveys, we generated convergence maps from our N-body simulations. Light cones were constructed from these simulations to model the observable universe, with particles inserted on-the-fly at the appropriate redshifts through interpolation between N-body time steps.

To balance computational efficiency with the need to accurately capture lensing effects, we set the width of each radial shell to $\Delta a = 0.01$, corresponding to a comoving distance of approximately $\Delta \chi \approx 100 \, h^{-1} \, \text{Mpc}$.

For each shell, the three-dimensional matter density $\delta(\mathbf{x}, z_i)$ was projected onto a two-dimensional plane perpendicular to the line of sight. The projected surface density $\Sigma(\hat{\mathbf{n}}, \chi_i)$ at an angular position $\hat{\mathbf{n}}$ was computed by integrating the matter density within the shell along the radial direction:
\begin{equation}
    \Sigma(\hat{\mathbf{n}}, \chi_i) = \int_{\chi_i}^{\chi_{i+1}} \delta(\chi \hat{\mathbf{n}}, z(\chi)) \, d\chi.
\end{equation}
In practice, the surface density was mapped onto a HEALPix grid \citep{Górski_2005} to create a full-sky map $\Sigma(n_j, \chi_i)$, where $n_j$ represents discretized angular positions. The HEALPix grid resolution was set to $N_{\text{side}} = 8192$, providing an angular resolution of approximately $0.43$ arcminutes, which is sufficient to capture small-scale structures relevant to weak lensing studies.

The convergence $\kappa(n_j; z_s)$ at each pixel of the HEALPix grid was then obtained by summing contributions from all the shells up to the source redshift:
\begin{equation}
    \kappa(n_j; z_s) = \sum_{i} W(\chi_i, \chi_s) \Sigma(n_j, \chi_i) \Delta \chi_i,
\end{equation}
where $W(\chi, \chi_s)$ is the lensing efficiency function.

We considered source redshifts $z_s$ from 0.5 to 2.5 in increments of 0.5, covering the range of distances relevant for current and future galaxy surveys, such as DES, LSST, \textit{Euclid}, and \textit{Roman}.

\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{figures/lensefficiency.png}
    \caption{Normalized lensing efficiency as a function of comoving distance for multiple source redshifts. The lensing efficiency peaks at intermediate comoving distances, indicating regions where the distribution of matter enhances the gravitational lensing signal.} \label{fig:lensing_efficiency}
\end{figure}
Figure~\ref{fig:lensing_efficiency} presents the normalized lensing efficiency as a function of comoving distance (measured in Mpc/$h$) for multiple source redshifts ($z$). Each curve corresponds to a specific source redshift, as detailed in the legend. The lensing efficiency curves exhibit peaks at intermediate comoving distances, indicating the regions where the distribution of matter along the line of sight most significantly enhances the gravitational lensing signal. 

\section{Incorporating Noise}
In real observations, measurements of the lensing signal are contaminated by noise arising from the intrinsic shapes of galaxies and errors in shape measurements. This noise, referred to as shape noise, constitutes a significant source of uncertainty, particularly on small angular scales.

To simulate shape noise, we added Gaussian noise to our convergence maps. We considered four different surveys with varying galaxy number densities, as detailed in Table~\ref{tab:noise}.

\begin{table}[h]
\centering
\begin{tabular}{lc}
\toprule
\textbf{Survey} & \textbf{Galaxy Number Density} [$\mathrm{arcmin}^{-2}$] \\
\midrule
DES/KiDS & 7 \\
HSC & 15 \\
\textit{Euclid}/LSST & 30 \\
\textit{Roman} & 50 \\
\bottomrule
\end{tabular}
\caption{Galaxy number densities for different surveys used to model shape noise levels.}\label{tab:noise}
\end{table}

The variance of the shape noise per pixel was calculated as:
\begin{equation}
    \sigma_{\kappa, \text{noise}}^2 = \frac{\sigma_{\epsilon}^2}{2 n_{\mathrm{gal}} A_{\mathrm{pix}}},
\end{equation}
where $\sigma_{\epsilon}$ is the intrinsic ellipticity dispersion of galaxies, set to $\sigma_{\epsilon} = 0.26$ \citep{2019A&A...627A..59E}, $n_{\mathrm{gal}}$ is the galaxy number density per square arcminute, and $A_{\mathrm{pix}}$ is the solid angle of a pixel, set to $0.43$ arcminutes$^2$.
We generated a Gaussian random field $n(\hat{\mathbf{n}})$ with the calculated variance and added it to the convergence maps:
\begin{equation}
    \kappa_{\mathrm{obs}}(\hat{\mathbf{n}}) = \kappa(\hat{\mathbf{n}}) + n(\hat{\mathbf{n}}).
\end{equation}

\section{Patch Extraction for Analysis}
In order to simlplify the analysis onto a flat patch, we extracted patches from the full-sky convergence maps. Each patch covers an area of $10^\circ \times 10^\circ$ and is uniformly distributed across the sky using a Fibonacci grid \citep{2006QJRMS.132.1769S, 2023MNRAS.524.5591F}. The center of each patch is positioned at the vertices of the Fibonacci grid defined by golden ratio spirals:
\begin{equation}
    \sin \theta_i = \frac{2i}{2N + 1}, \quad \phi_i = \frac{2 \pi i}{\varphi}, \quad -N \leq i \leq N, \quad -\frac{\pi}{2} \leq \theta_i \leq \frac{\pi}{2},
\end{equation}
where $N$ is the number of patches and $\varphi = (1 + \sqrt{5})/2$ is the golden ratio.

The number of patches, denoted \( N_{\text{patches}} \), was optimized to ensure that individual patches do not overlap, except in regions near the poles where overlapping patches were subsequently discarded. The optimization process commenced with an initial count of \( N_{\text{patches}} = 400 \) and involved iteratively reducing this number until a configuration was achieved wherein the patches remained non-overlapping, except for centers located within \( 5\sqrt{2}^\circ \, \mathrm{\deg}\) of the poles.

To verify the absence of overlap between patches, we calculated the vertices of each patch and conducted pairwise overlap checks with all other patches. For a Fibonacci grid center characterized by coordinates \( (\theta_i, \phi_i) \), the vertices of the corresponding patch are defined as:
\begin{align}
    \left( \theta_i - \Delta \theta,\, \phi_i - \Delta \phi \right), \quad &\left( \theta_i - \Delta \theta,\, \phi_i + \Delta \phi \right), \nonumber \\
    \left( \theta_i + \Delta \theta,\, \phi_i - \Delta \phi \right), \quad &\left( \theta_i + \Delta \theta,\, \phi_i + \Delta \phi \right),
\end{align}
where
\begin{align}
    \Delta \theta = 5\sqrt{2}\, \mathrm{\deg}, \quad \Delta \phi = 5\sqrt{2}\sin \theta_i \, \mathrm{\deg}.
\end{align}
After optimization, the number of patches was set to $N_{\text{patches}} = 273$, effectively reducing to $N_{\text{patches}} = 265$ after excluding overlapping regions near the poles. The visualization of the Fibonacci grid is shown in Figure~\ref{fig:fibonacci}.
\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/fibonacci_grid.png}
    \caption{Visualization of the Fibonacci grid with $N_{\text{patches}} = 273$ patches, each covering approximately $10 \times 10$\,deg$^2$. The left panel shows the full-sphere distribution of patches, where the placement is optimized to ensure minimal overlap, except near the poles where overlapping patches are discarded. The right panel provides a top-down view, highlighting the arrangement near the poles and the systematic exclusion of overlapping regions. After this optimization, the effective number of patches is reduced to $N_{\text{patches}} = 265$, ensuring uniform and efficient tiling across the sphere for cosmological analyses.}\label{fig:fibonacci}
\end{figure}

Using the vertices of the Fibonacci grid as centers, we employed the \texttt{gnomview} function from the \texttt{healpy} library \citep{Zonca2019} to project each spherical patch onto a flat plane via a gnomonic projection. Each patch is represented by a $2048 \times 2048$ grid of pixels, resulting in a pixel size of:
\begin{equation}
    \Delta \theta = \frac{10^\circ}{2048} \approx 0.00488^\circ \approx 0.293' \quad \text{per pixel}.
\end{equation}
The large number of patches provided a robust sample for our statistical analysis, helping us to understand the uncertainties in our measurements and how they might vary across different regions of the sky.

\section{Discretized Pixel Approach}
For practical purposes, the continuous integral over comoving distance can be discretized into a series of narrow redshift bins or shells. This discretization allows the convergence map to be constructed by summing the contributions from each shell:
\begin{equation}
    \kappa(\hat{\boldsymbol{n}}) = \sum_j \kappa^j(\hat{\boldsymbol{n}}) = \sum_j W^j \delta^j(\hat{\boldsymbol{n}}) \Delta \chi^j,
\end{equation}
where $\Delta \chi^j$ is the thickness of the $j$-th shell, $W^j = W(\chi^j, \chi_s)$ is the lensing efficiency at that shell, and $\delta^j(\hat{\boldsymbol{n}})$ is the density contrast projected onto that shell in the direction $\hat{\boldsymbol{n}}$.
The effective comoving distance to the center of the $j$-th shell, $\chi^j$, is calculated as \citep{2015MNRAS.453.3043S}:
\begin{equation}
    \chi^j = \frac{\int_{\chi_{\min}}^{\chi_{\max}} \chi^3 \, \mathrm{d}\chi}{\int_{\chi_{\min}}^{\chi_{\max}} \chi^2 \, \mathrm{d}\chi} = \frac{3}{4} \frac{\chi_{\max}^4 - \chi_{\min}^4}{\chi_{\max}^3 - \chi_{\min}^3},
\end{equation}
The density contrast within the $i$-th pixel of the $j$-th shell, $\delta^j(\hat{\boldsymbol{n}}_i)$, is determined by:
\begin{equation}
    \delta^j(\hat{\boldsymbol{n}}_i) = \frac{n_{\mathrm{part}, i}^j}{\bar{n}_{\mathrm{part}}^j} - 1,
\end{equation}
where $n_{\mathrm{part}, i}^j$ is the number of particles in the $i$-th pixel of the $j$-th shell, and $\bar{n}_{\mathrm{part}}^j$ is the average number of particles per pixel in that shell. This formulation ensures that the mean density contrast within each shell is zero, providing a normalized measure of density fluctuations.

\section{Gaussian Smoothing}
Shape noise predominantly affects small angular scales. To mitigate this noise and enhance the detection of the underlying lensing signal, we applied Gaussian smoothing to the noisy convergence maps. The Gaussian filter used is defined by:
\begin{equation}
    W(\theta) = \frac{1}{\pi \theta_{\mathrm{G}}^2} \exp\left( -\frac{\theta^2}{\theta_{\mathrm{G}}^2} \right),
\end{equation}
where $\theta$ is the angular distance from the center of the filter, and $\theta_{\mathrm{G}}$ is the smoothing scale. For our analysis, we selected $\theta_{\mathrm{G}} = 2'$, $5'$, $8'$, and $10'$.

By convolving the noisy convergence map with the Gaussian filter, we obtained the smoothed convergence map:
\begin{equation}
    \kappa_{\mathrm{smoothed}}(\hat{\mathbf{n}}) = \int d\Omega' \, W(|\hat{\mathbf{n}} - \hat{\mathbf{n}}'|) \kappa_{\mathrm{obs}}(\hat{\mathbf{n}}').
\end{equation}

Figure~\ref{fig:smoothing} demonstrates the application of Gaussian smoothing to a noisy convergence map. The figure presents four panels, each corresponding to a different smoothing scale: $\theta_{\mathrm{G}} = 2'$, $5'$, $8'$, and $10'$. As the smoothing scale increases, the convolution of the convergence map with the Gaussian filter effectively reduces small-scale noise, as evidenced by the diminishing high-frequency fluctuations in the map. 
\begin{figure}[ht]
    \centering
    \includegraphics[width=\textwidth]{figures/smoothed_comparison.png}
    \caption{Effect of Gaussian smoothing on a noisy convergence map. Each panel shows the result of applying a Gaussian filter with a different smoothing scale $\theta_{\mathrm{G}} = 2'$, $5'$, $8'$, and $10'$. As the smoothing scale increases, small-scale noise is progressively suppressed, and large-scale structures become more prominent. This demonstrates how Gaussian smoothing effectively reduces shape noise while enhancing the detection of the underlying lensing signal.}
\label{fig:smoothing}
\end{figure}

\section{Measurements}
In order to characterize the influence of super-sample covariance on higher-order statistics, this study concentrates on the bispectrum, probability distribution function (PDF), peak counts, minima counts, and Minkowski functionals. These statistical measures offer complementary insights into the underlying matter distribution and exhibit sensitivity to distinct features of the gravitational lensing signal.

\subsection{Statistical Measures and Computational Methods}
Table~\ref{tab:statistics} delineates the range of values and the computational subroutines employed for each statistical measure. Each statistic is computed both for full-sky analyses and sky patches, utilizing the appropriate methodologies as specified.
\begin{table*}[htbp]
    \centering
    \begin{tabular}{lcc}
    \toprule
    \textbf{Statistic} & \textbf{Range} & \textbf{Subroutine (Sky Patch)} \\
    \midrule
    Angular Power Spectrum & $300 \leq \ell \leq 3000$ & \texttt{lenstools.powerSpectrum} \\
    Bispectrum & $300 \leq \ell \leq 3000$ & \texttt{lenstools.bispectrum} \\
    Peak Counts & $-4 \leq \kappa/\sigma_\kappa \leq 4$ & \texttt{lenstools.peakCount} \\
    Minima Counts & $-4 \leq \kappa/\sigma_\kappa \leq 4$ & \texttt{lenstools.peakCount} \\
    Probability Distribution Function (PDF) & $-4 \leq \kappa/\sigma_\kappa \leq 4$ & \texttt{lenstools.pdf} \\
    Minkowski Functionals & $-4 \leq \kappa/\sigma_\kappa \leq 4$ & \texttt{lenstools.minkowskiFunctionals} \\
    \bottomrule
    \end{tabular}
    \caption{Summary of the statistical measures employed in this investigation, including their respective value ranges and computational subroutines utilized for both full-sky and sky-patch analyses.}\label{tab:statistics}
\end{table*}
The angular power spectrum, denoted as $C_{\ell}^{\kappa\kappa}$, alongside three configurations of the bispectrum, $B_{\ell_1\ell_2\ell_3}^{\kappa\kappa\kappa}$, are derived from unsmoothed convergence maps. The bispectrum calculations encompass three distinct configurations:
\begin{itemize}
    \item \textbf{Equilateral Configuration}: $\ell_1 = \ell_2 = \ell_3$.
    \item \textbf{Squeezed Configuration}: $\ell_1 = \ell_2 = 10\ell_3$.
    \item \textbf{Isosceles Configuration}: $\ell_1 = \ell_2 = 2\ell_3$.
\end{itemize}
All bispectrum computations are confined within the multipole range $\ell \in [300, 3000]$.

Conversely, the PDF, peak counts, minima counts, and Minkowski functionals are derived from smoothed convergence maps, where the smoothing angle is fixed at 2 arcminutes for the primary results. These measurements are conducted within the normalized range $-4 \leq \kappa/\sigma_{\kappa} \leq 4$. To mitigate local effects, the convergence map $\kappa$ is normalized by the global standard deviation $\sigma_{\kappa}$.

All statistical computations are performed using the \texttt{lenstools} package \citep{2016A&C....17...73P}.

\subsection{Covariance Matrix Estimation}
Following the measurement phase, this study examines the influence of super-sample covariance on the covariance matrices associated with the aforementioned statistical measures. To achieve this, we employ an unbiased estimator for the covariance matrix as previously defined in Equation~\ref{eq:covariance}. The analysis utilizes 10 realizations from the BIGBOX simulation and 20 realizations from the TILED simulation. For each realization, the covariance is computed using 265 patches extracted from the full-sky map of each simulation.

\subsection{Decomposition of Covariance Matrices}
The covariance matrices for the BIGBOX and TILED simulations are assumed to decompose as follows:
\begin{align}
    \text{Cov}^{\text{BIGBOX}} &= \text{Cov}^{\text{G}} + \text{Cov}^{\text{SSC}}, \\
    \text{Cov}^{\text{TILED}} &= \text{Cov}^{\text{G}} + \text{Cov}^{\text{T}},
\end{align}
where:
$\text{Cov}^{\text{G}}$ include all the contributions to the covariance matrix that are not due to super-sample covariance or tiling effects, such as shape noise, cosmic variance, and pixelization effects.
$\text{Cov}_{\text{SSC}}$ and $\text{Cov}_{\text{T}}$ represent the contributions from super-sample covariance and tiling effects, respectively.
The difference in the diagonal terms of the covariance matrix between the BIGBOX and TILED simulations is given by:
\begin{equation}
    \Delta \text{Cov}_{ii} = \text{Cov}_{ii}^{\text{BIGBOX}} - \text{Cov}_{ii}^{\text{TILED}} = \text{Cov}^{\text{SSC}}_{ii} - \text{Cov}^{\text{T}}_{ii}.
\end{equation}
Given that the contributions from tiling effects and super-sample covariance are intertwined within the observed differences, the analysis is constrained to discussing only the lower bound of the super-sample covariance effect. This is further justified by the fact that the signs of the covariances differ and the covariance matrices are positive definite, ensuring that the observed differences provide a conservative estimate of the super-sample covariance's impact.

From an alternative perspective, the ratio of the covariance matrices can be considered:
\begin{equation}
    \text{R}_{ij} = \frac{\text{Cov}_{ij}^{\text{BIGBOX}}}{\text{Cov}_{ij}^{\text{TILED}}} = \frac{1 + \tfrac{\text{Cov}^{\text{SSC}}_{ij}}{\text{Cov}^{\text{G}}_{ij}}}
    {1 + \tfrac{\text{Cov}^{\text{T}}_{ij}}{\text{Cov}^{\text{G}}_{ij}}}.
\end{equation}
In scenarios where the super-sample covariance effect predominates, the ratio $\text{R}_{ij}$ exceeds unity, thereby quantifying the extent to which super-sample covariance influences the covariance matrix relative to other contributing factors.

Furthermore, the correlation matrix $\rho_{ij}$ is computed as:
\begin{equation}
    \rho_{ij} = \frac{\text{Cov}_{ij}}{\sqrt{\text{Cov}_{ii} \text{Cov}_{jj}}}.
\end{equation}
A similar analysis is conducted for the correlation matrices, analogous to the discussion presented for the covariance matrices.